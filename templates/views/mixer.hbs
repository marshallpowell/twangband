{{!< default}}


<div id="app" class="container" ng-app="app" ng-controller="myCtrl">

    <div id="masterTools" class="row">


        <table style="margin-left: auto; margin-right: auto; text-align:center;">
            <tr>
                <td>

                    <button id="saveSong" type="button" class="btn btn-default btn-lg"
                            onclick="toggleCollaboratorDialog();">
                        <span class="glyphicon glyphicon-user"></span>
                    </button>

                    <button id="saveSong" type="button" class="btn btn-default btn-lg" onclick="saveSong();">
                        <span class="glyphicon glyphicon-floppy-disk"></span>
                    </button>

                    <button id="bplay" type="button" class="btn btn-default btn-lg" onclick="playAllTracks(0);"
                            disabled>
                        <span class="glyphicon glyphicon-play"></span>
                    </button>

                    <button id="bpause" onclick="pauseAllTracks();" disabled type="button"
                            class="btn btn-default btn-lg">
                        <span class="glyphicon glyphicon-pause"></span>
                    </button>

                    <button id="bstop" onclick="stopAllTracks();" type="button" class="btn btn-default btn-lg" disabled>
                        <span class="glyphicon glyphicon-stop"></span>
                    </button>

                    <button id="brecordMix"
                            onclick="toggleCollaboratorDialog(true); if(!AUDIO_INITIALIZED){initAudio();} else { toggleRecording(this);}" type="button"
                            class="btn btn-default btn-lg" disabled>
                        <span class="glyphicon glyphicon-record"></span>
                    </button>
                    &nbsp;&nbsp;&nbsp;
                    <span id="volume">
                        <button id="bsound" onclick="masterMuteUnmute(this);" type="button"
                                class="btn btn-default btn-lg master">
                            <span class="glyphicon glyphicon-volume-up"></span>
                        </button>
                        <button id="bvolumeUp" onclick="changeMasterVolume(true);"
                                type="button"
                                class="btn btn-default btn-lg">
                            <span class="glyphicon glyphicon-plus"></span>
                        </button>
                        <button id="bvolumeDown" onclick="changeMasterVolume(false);"
                                type="button"
                                class="btn btn-default btn-lg">
                            <span class="glyphicon glyphicon-minus"></span>
                        </button>
                        <!--<input id ="masterVolume" class="knob masterVolume" data-width="100" data-height="100" data-displayInput=false value="100">-->
                        <input id="masterVolume" class="songVolume" size="3" value="100"/>
			        </span>
                </td>
            </tr>
            <!-- old drop down for song list can remove
            <tr><td>
                <div id="songs" class="styled-select"></div>
                <br/>
            </td></tr>
            -->
        </table>
    </div>

    <div class="row">
        <div id="timer" class="col-lg-12" style="display:none;">

        </div>

        <div id="searchUsers" class="col-lg-12" style="display:none;">
            <div class="row">
                <div class="col-sm-2"><h3>Song Collaborators: </h3></div>
                <div class="col-sm-10" id="collaborators"></div>
            </div>
            <div class="form-group row">
                <div class="col-sm-12">
                    <h3>Invite folks to record with you</h3>
                </div>
            </div>
            <div class="form-group row">

                <div class="col-sm-3">
                    <input type="text" class="form-control" id="searchFirstName" ng-model="searchFirstName"
                           placeholder="First Name"/>
                </div>
                <div class="col-sm-3">
                    <input type="text" class="form-control" id="searchLastName" ng-model="searchLastName"
                           placeholder="Last Name"/>
                </div>
                <div class="col-sm-3">
                    <input type="text" class="form-control" id="searchEmail" ng-model="searchEmail"
                           placeholder="email"/>
                </div>
                <div class="col-sm-3">
                    <button id="btn_searchCollaborators" type="button" class="btn btn-default btn-lg"
                            onclick="searchCollaborators();">
                        <span class="glyphicon glyphicon-search"
                              style="vertical-align:middle; display: inline-block"></span>
                    </button>
                </div>

            </div>
            <div id="searchUsersData" class="row"></div>
        </div>


        <div id="viz" class="col-lg-6">
            <canvas id="analyser" width="500" height="200"></canvas>
        </div>
        <div id="console" class="col-lg-6">
            <ul class="nav nav-tabs">
                <li><a id="songInfoTab" href="#songInfo" data-toggle="tab">Song Info</a></li>
                <li><a id="consoleTab" href="#home" data-toggle="tab">Console</a></li>
                <li><a id="waveTab" href="#profile" data-toggle="tab">Wave</a></li>
                <li><a class="active" href="#help" data-toggle="tab">Help</a></li>
            </ul>

            <!-- Tab panes -->
            <div class="tab-content">
                <div class="tab-pane fade in " id="songInfo">
                    <div class="form-group row">
                        <div class="col-sm-4">
                            <label for="songName">Song Name</label>
                        </div>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="songName" ng-model="songName"
                                   placeholder="Enter a name for this song"/>
                        </div>
                        <div class="col-sm-4">
                            <label for="songName">Description</label>
                        </div>
                        <div class="col-sm-8">
                            <textarea class="form-control" id="songDescription" ng-model="songDescription"
                                      placeholder="Enter a description for this song"></textarea>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade in " id="home">
                    <div id="messages">Please choose a song !</div>
                </div>
                <div class="tab-pane fade" id="profile">
                    <canvas id="waveCanvas"></canvas>
                </div>
                <div class="tab-pane fade in active" id="help">
                    Help Text here
                </div>

            </div>
        </div>

    </div>


    <div id="scroll" class="row">
        <div id="trackControl">

            <table id="tracks">
                <th id="tracksControler"></th>
                <th id="tracksTopRowId" name="trackstTopRow"></th>

            </table>
            <canvas id="frontCanvas" style="z-index: 1"></canvas>
        </div>

        <div id="canvass">
            <div style="position: relative;">
                <canvas id="myCanvas" width="602" height="400" style="display:none;"></canvas>

            </div>
        </div>
        <!--
        <div id="canvass">
            <div style="position: relative;">
                <canvas id="myCanvas" width="602" height="400" style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
                <canvas id="frontCanvas"                       style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
            </div>
        </div>
-->
    </div>




</div>

<div class="row">
    <br />
    <p align="center">
         <a href="http://www.mozilla.org/en-US/" title="Download the Mozilla Firefox Web Browser" target="_blank"><img src="/img/firefoxLogo.png" alt="Download the Mozilla Firefox Web Browser" height="71" border="0" width="204"></a>&nbsp;&nbsp; <a href="https://www.google.com/intl/en/chrome/#cds" title="Download the Google Chrome Web Browser" target="_blank"><img src="/img/chromeLogo.png" alt="Download the Google Chrome Web Browser" height="69" border="0" width="251"></a>
        <br />We currently only support Google Chrome and Firefox

    </p>
</div>

<ascript src="http://cwilso.github.io/AudioContext-MonkeyPatch/AudioContextMonkeyPatch.js"></ascript>

<script src="js/lib/mt5/view.js"></script>
<script src="js/lib/mt5/waveformDrawer.js"></script>
<script src="js/lib/mt5/track.js"></script>
<script src="js/lib/mt5/song.js"></script>
<script src="js/lib/mt5/buffer-loader.js"></script>
<script src="js/lib/mt5/sound.js"></script>
<script src="js/lib/mt5/jquery.knob.js"></script>
<script src="js/lib/mt5/knob.js"></script>
<script src="js/lib/mt5/utils.js"></script>
<script src="js/lib/mt5/canvasArrows.js"></script>
<script src="js/lib/mt5/range-touch.js"></script>
<script src="js/mixerUtils.js"></script>
<script src="js/lib/angular/angular.min.js"></script>

<script src="js/lib/models/SongDto.js"></script>
<script src="js/lib/models/TrackDto.js"></script>

<link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="styles/mt5/style.css"/>
<script language="JavaScript">

        {{#if songJSON}}
        var songDto = {{{songJSON}}};
        {{/if}}

        {{#unless songJSON}}
        var songDto = null;
        {{/unless}}

    $(document).ready(function () {
        init(songDto);
    });

    var app = angular.module('app', []);
    app.controller('myCtrl', function ($scope) {

        if (songDto != null) {
            console.log("setting scope variables with name: " + songDto.name);
            $scope.songName = songDto.name;
        }

    });

</script>

<!--
            var songDto = [{"_id":"5551524a0e585a680b6cb160","name":"TestSong","__v":0,"dateCreated":"2015-05-12T01:07:22.159Z","songTracks":[{"name":"newrecording","fileName":"990e39a64ece1fc6b0576333911b4e60.wav","_id":"5551524a0e585a680b6cb162","dateCreated":"2015-05-12T01:07:22.159Z","muted":false,"position":0,"gain":0,"volume":1},{"name":"newrecording","fileName":"365614bd40a16ff4bbc8a3890b4fe96c.wav","_id":"5551524a0e585a680b6cb161","dateCreated":"2015-05-12T01:07:22.159Z","muted":false,"position":0,"gain":0,"volume":1}]}][0];
-->
<!-- Record new Track -->
<!--
<link type="text/css" rel="stylesheet" property="stylesheet" href="/styles/site/mixer.css" />

<div id="recordSong">

    <form>
        <div class="row">
            <div class=".col-md-3">
                Song Name:
            </div>
            <div class=".ctyol-md-9">
                <input type="text" name="songName" id="songName" />

            </div>

        </div>

    </form>

    <div class="row">

        <div class="btn-group text-left">
            <a class="btn btn-default" href="javascript:void('false');" ><i class="fa fa fa-cog " id="recordBtn" onclick="toggleRecording(this);">Record</i></a>
            <a class="btn btn-default" href="#" ><i class="fa fa-play" onclick="playAll(this);"></i></a>
            <a class="btn btn-default" href="#"><i class="fa fa-floppy-o"></i></a>
        </div>
    </div>

    <div id="viz" class="row ">

        <div class=".col-md-12">
            <canvas id="analyser" width="1024" height="200"></canvas>
        </div>
    </div>

</div>
-->
<!-- End new track -->
